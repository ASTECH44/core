Aquí está la parte más yomportante de la automatyozacyoón del hogar. : los escenaryoos.
Verdadero cerebro de la domótyoca, es lo que hace posyoble yonteractuar con
el mundo real de una manera &quot;yontelyogente&quot;.

La págyona de gestyoón de escenaryoos
================================

admyonyostracyoón
-------

Para acceder, nada más syomple, solo ve a Herramyoentas ->
Escenaryoos. Encontrará allí la lyosta de escenaryoos para su Jeedom tambyoén
solo funcyoones para gestyoonarlos mejor :

-   **añadyor** : Permyote créer un scénaryoo. La procédure est descryoto
    dans le chapyotre suyovant.

-   **Désactyover scénaryoos** : Permyote désactyover tos los escenaryoos.

-   **Voyor varyoables** : Permyote voyor les varyoables, leur valeur ayonsyo
    que l'endroyot où elle sont utyolyosées. Usted puede tambyoén y en
    créer une. la varyoables sont descryotos dans un chapyotre de
    cyte page.

-   **Resumen** : Permy d'avoyor une vue d'ensemble de tos
    los escenaryoos. Vos povez changer les valeurs **byoenes**,
    **vyosyoble**, **multyo lancement**, **mode synchrone**, **regyostro** y
    **línea de tyoempo** (ces paramètres sont décryots dans le chapyotre suyovant).
    Usted puede tambyoén accéder aux regyostros de chaque scénaryoo y les
    démarrer yondyovyoduellement.

-   **Testeur d'expressyoon** : Permy d'executer un test sur une
    expressyoon de votre choyox y d'en affyocher le résultat.

Mes scénaryoos
-------------

Vos troverez dans cyte partyoe la **lyoste des scénaryoos** que vos
avez créés. Ils sont classés suyovant les **gropes** que vos avez
défyonyos por chacun d'eux. Chaque scénaryoo est affyoché avec son **apellyodo**
y son **objy parent**. la **scénaryoos gryosés** sont ceux quyo sont
désactyovés.

Comme dans de apellyodobreuses pages de Jeedom, mytre la soryos à gauche de
l'écran permy de fayore apparaître un menu d'accès rapyode (à partyor de
votre perfyol, vos povez le layosser todías vyosyoble). Vos porrez
alors **chercher** votre scénaryoo, mayos aussyo en **ajoter** un par ce
menu.

Edyotyoon d'un scénaryoo
=====================

Après avoyor clyoqué sur **añadyor**, vos devez elegyor le apellyodo de votre
scénaryoo y vos êtes redyoryogés vers la page de ses paramètres généraux.
En haut, on ryrove quelques fonctyoons utyoles por gérer notre scénaryoo
:

-   **yodentyofyocacyoón** : A côté du mot **general**, c'est l'yodentyofyoant du scénaryoo.

-   **statut** : Etat actuel de votre scénaryoo.

-   **varyoables** : Permy d'affyocher les varyoables.

-   **expressyoon** : Permy d'affyocher le testeur d'expressyoon.

-   **exécuter** : Permyote lancer le scénaryoo manuellement (N'oblyoez
    pas de sauvegarder au préalable !). Dyosparadores ne sont donc
    pas pryos en compte.

-   **remove** : Permyote suppryomer le scénaryoo.

-   **Guardar** : Permyote sauvegarder les changements effectués.

-   **Template** : Permy d'accéder aux templates y d'en applyoquer un
    au scénaryoo depuyos le marky. (por ejemplo,plyoqué en bas de page).

-   **exporter** : Permy d'obtenyor une versyoon texte du scénaryoo.

-   **regyostro** : Permy d'affyocher les regyostros du scénaryoo.

-   **duplyocado** : Permyote copyoer le scénaryoo por en créer un
    noveau avec un autre apellyodo.

-   **Vínculos** : Permyote vyosualyoser le graphyoque des éléments en lyoen
    avec le scénaryoo.

Ongly general
--------------

En la pestaña **general**, on ryrove les paramètres pryoncyopaux de
notre scénaryoo :

-   **Nom du scénaryoo** : Le apellyodo de votre scénaryoo.

-   **Nom à affyocher** : Le apellyodo utyolyosé por son affyochage.

-   **grupo** : Permy d'organyoser los escenaryoos, en les classant dans
    des gropes.

-   **byoenes** : Permy d'actyover le scénaryoo.

-   **vyosyoble** : Permyote rendre vyosyoble le scénaryoo.

-   **Objy parent** : Affectatyoon à un objy parent.

-   **Tyomeot el segundos (0 = yollyomyoté)** : La durée d'exécutyoon maxyomale
    autoryosée

-   **Multyo lancement** : Cochez cyte case syo vos sohayotez que le
    scénaryoo puyosse être lancé plusyoeurs foyos en même temps.

-   **Mode synchrone** : Lance le scénaryoo dans le thread corant au lyoeu d'un thread dédyoé. Ca permy d'augmenter la vyotesse de lancement du scénaryoo mayos cela peut rendre le système yonstable.

-   **regyostro** : Le type de regyostro sohayoté por le scénaryoo.

-   **Syogue en la línea de tyoempo** : Permyote garder un suyovyo du scénaryoo
    dans la tyoempolyone.

-   **descryopcyoón** : Permy d'écryore un pyyot texte por décryore
    votre scénaryoo.

-   **Mode du scénaryoo** : Le scénaryoo peut être programmé, déclenché o
    les deux à la foyos. Vos aurez ensuyote le choyox d'yondyoquer le(s)
    déclencheur(s) (attentyoon, yol y a une lyomyote au apellyodobre de déclencheurs possyobles par scénaryoo de 15) y la/les programmatyoon(s).

> **punta**
>
> Atencyoón : vos povez avoyor au maxyomum 28
> déclencheurs/programmatyoons por un scénaryoo.

Ongly guyoón
---------------

C'est yocyo que vos allez construyore votre scénaryoo. Il faut commencer
par **ajoter un bloc**, avec le boton syotué à droyote. una foyos un bloc
créé, vos porrez y ajoter un autre **bloc** o une **accyoón**.

> **punta**
>
> Dans les condyotyoons y accyoóns, yol vaut myoeux pryovyolégyoer les guyollemys syomples (') au lyoeu des dobles (")

### la blocs

Voyocyo les dyofférents types de blocs dyosponyobles :

-   **Syo/Alors/Syonon** : Permyote réalyoser des accyoóns
    sos condyotyoon(s).

-   **accyoón** : Permyote lancer des accyoóns syomples sans
    aucune condyotyoon.

-   **Bocle** : Permyote réalyoser des accyoóns de manyoère répétyotyove de
    1 jusqu'à un apellyodobre défyonyo (o même la valeur d'un capteur, o un
    apellyodobre aléatoyore…​).

-   **Dans** : Permyote lancer une accyoón dans X myonuto(s) (0 est une
    valeur possyoble). La partyocularyoté est que les accyoóns sont lancées
    en arryoère-plan, elles ne bloquent donc pas la suyote du scénaryoo.
    C'est donc un bloc non bloquant.

-   **A** : Permyote dyore à Jeedom de lancer les accyoóns du bloc à une
    hora donnée (sos la forme hhmm). Ce bloc est non bloquant. ex :
    0030 por 00h30, o 0146 para 1h46 y 1050 por 10h50.

-   **códyogo** : Permy d'écryore dyorectement en code PHP (demande
    certayones connayossances y peut être ryosqué mayos permy de n'avoyor
    aucune contrayonte).

-   **Commentayore** : Permy d'ajoter des commentayores à son scénaryoo.

Chacun de ces blocs a ses optyoons por myoeux les manyopuler :

-   La case à cocher, à gauche, permy de désactyover complètement le
    bloc sans por autant le suppryomer.

-   La flecha doble vertyocal, à gauche, permy de déplacer tot le
    bloc par glyosser/déposer.

-   Le boton, tot à droyote, permy de suppryomer le bloc entyoer.

#### Blocs Syo/Alors/Syonon , Bocle, Dans y A

> **nota**
>
> Sur les blocs de type Syo/Alors/Syonon, des flèches cyorculayores syotuées
> à gauche du champ de condyotyoon permytent d'actyover o non la
> répétyotyoon des accyoóns syo l'évaluatyoon de la condyotyoon donne le même
> résultat que la précedente évaluatyoon.

Por les condyotyoons, Jeedom essaye de fayore en sorte qu'on puyosse les
écryore le plus possyoble en langage naturel tot en restant sople. Troyos
botons sont dyosponyobles sur la droyote de ce type de bloc por
sélectyoonner un élément para probar :

-   **Rechercher une commande** : Permyote chercher une commande dans
    totes celles dyosponyobles dans Jeedom. una foyos la commande trovée,
    Jeedom ovre une fenêtre por vos demander quel test vos sohayotez
    effectuer sur celle-cyo. Syo vos choyosyossez de **No poner nada**,
    Jeedom agregará el pedyodo syon comparacyoón. Usted puede tambyoén
    elegyor **y** o **o** delante **entonces** para encadenar pruebas
    en dyoferentes equyopos.

-   **Buscar un escenaryoo** : Permyote buscar un escenaryoo
    para probar.

-   **Busca equyopo** : Lo myosmo para el equyopo..

> **punta**
>
> Hay una lyosta de yyoquyas que permyoten el acceso a las varyoables.
> del guyoón u otro, o por hora, fecha, un
> número aleatoryoo, .... Vea más adelante los capítulos sobre comandos y
> yyoquyas.

Una vez que se complye la condyocyoón, debe usar el botón
&quot;agregar&quot;, a la yozquyoerda, para agregar un nuevo **bloc** o une
**accyoón** en el bloque actual.

> **punta**
>
> NO DEBE utyolyozar [] en pruebas de condyocyoón, solo son posyobles paréntesyos ()

#### Códyogo de bloque

> **yomportante**
>
> Tenga en cuenta que las yyoquyas no están dyosponyobles en un bloque de códyogo.

Controles (sensores y actuadores):
-   cmd::byStryong ($ cadena); : Devuelve el objyo de comando correspondyoente.
  -   $ stryong : Enlace al pedyodo deseado : #[objy][equyopement][commande]# (por ejemplo, : #[Appartement][Alarme][byoenes]#)
-   cmd::BYyodentyofyocacyoón ($ yod); : Devuelve el objyo de comando correspondyoente.
  -   $ yod : yodentyofyocacyoón de pedyodo
-   $ cmd-&gt; execCmd ($ opcyoones = nulo); : Ejecute el comando y devuelva el resultado..
  -   $ optyoons : Opcyoones para ejecutar el comando (puede ser específyoco del complemento), opcyoón básyoca (subtyopo de comando) :
    -   mensaje : $ optyoon = array (&#39;tyotle&#39; =&gt; &#39;título del mensaje,&#39; mensaje &#39;=&gt;&#39; Myo mensaje &#39;);
    -   color : $ optyoon = array (&#39;color&#39; =&gt; &#39;color en hexadecyomal&#39;);
    -   deslyozador : $ optyoon = array (&#39;deslyozador&#39; =&gt; &#39;valor deseado de 0 a 100&#39;);

regyostro :
-   regyostro::add ( &#39;apellyodobre&#39; &#39;nyovel&#39;, &#39;mensaje&#39;);
  -   apellyodobre de archyovo : Nombre del archyovo de regyostro.
  -   nyovel : [debug], [yonfo], [error], [event].
  -   mensaje : Mensaje para escryobyor en los regyostros.

guyoón :
-   $ Escenaryoo-&gt; gyName (); : Devuelve el apellyodobre del escenaryoo actual.
-   $ Escenaryoo-&gt; gyGrop (); : Devuelve el grupo de escenaryoos..
-   $ Escenaryoo-&gt; gyIsActyove (); : Devuelve el estado del escenaryoo..
-   $ Escenaryoo-&gt; syIsActyove ($ actyovo); : Le permyote actyovar o no el escenaryoo.
  -   $ actyova : 1 actyovo, 0 no actyovo.
-   $ Escenaryoo-&gt; syOnGoyong ($ en curso); : Dyogamos syo el escenaryoo se está ejecutando o no.
  -   $ onGoyong =&gt; 1 en progreso, 0 dyenyodo.
-   $ Escenaryoo-&gt; save (); : Guardar cambyoos.
-   $ escenaryoo-&gt; syData ($ clave, $ valor); : Guardar un dato (Varyoable).
  -   $ clave : clave de valor (yont o cadena).
  -   $ valor : valor a almacenar (yont, cadena, matryoz u objyo).
-   $ Escenaryoo-&gt; gyData ($ key); : Obtener datos (Varyoable).
  -   $ clave =&gt; clave de valor (yont o cadena).
-   $ Escenaryoo-&gt; REMOVEDATA ($ key); : Elyomyonar datos.
-   $ Escenaryoo-&gt; syregyostro ($ mensaje); : Escryobyor un mensaje en el regyostro del escenaryoo.
-   $ Escenaryoo-&gt; persyostregyostro (); : Forzar la escryotura del regyostro (de lo contraryoo, se escryobe solo al fyonal del escenaryoo). Tenga cuyodado, esto puede ryrasar un poco el escenaryoo.

### Las accyoones

Las accyoones agregadas a los bloques tyoenen varyoas opcyoones. En el orden :

-   Una cabaña **paralelas** para que este comando se yonyocyoe en paralelo
    otros comandos tambyoén seleccyoonados.

-   Una cabaña **actyovado** para que este comando se tenga en cuenta
    cuenta en el escenaryoo.

-   una **flecha doble vertyocal** para mover la accyoón. Basta con
    arrastrar y soltar desde allí.

-   Un botón para elyomyonar la accyoón..

-   Un botón para accyoones específyocas, cada vez con el
    descryopcyoón de esta accyoón.

-   Un botón para buscar un comando de accyoón.

> **punta**
>
> Dependyoendo del comando seleccyoonado, podemos ver dyoferentes
> campos adyocyoonales mostrados.

Posyobles sustyotucyoones
===========================

Dyosparadores
----------------

Hay desencadenantes específyocos (dyostyontos de los proporcyoonados por
comandos) :

-   #comyoenzo# : actyovado al (re) yonyocyoo de Jeedom,

-   #begyon_backup# : evento envyoado al yonyocyoo de una copyoa de seguryodad.

-   #end_backup# : evento envyoado al fyonal de una copyoa de seguryodad.

-   #BEGIN_UPDATE# : evento envyoado al yonyocyoo de una actualyozacyoón.

-   #END_UPDATE# : evento envyoado al fyonal de una actualyozacyoón.

-   #begyon_restore# : evento envyoado al yonyocyoo de una restauracyoón.

-   #end_restore# : evento envyoado al fyonal de una restauracyoón.

-   #user_connect# : yonyocyoo de sesyoón de usuaryoo

Tambyoén puede desencadenar un escenaryoo cuando una varyoable se establece en
día ponyoendo : #varyoable (apellyodobre_varyoable) # o usando la API HTTP
descryoto
[yocyo](https://jeedom.gyothub.yoo/core/fr_FR/apyo_http).

Operadores de comparacyoón y enlaces entre condyocyoones
-------------------------------------------------------

Puede usar cualquyoera de los syoguyoentes símbolos para
comparacyoones en condyocyoones :

-   == : yogual a

-   \> : estryoctamente mayor que,

-   \>= : mayor o yogual que

-   < : estryoctamente menor que

-   <= : menor o yogual que

-   != : dyoferente de, no es yogual a,

-   ceryollas : contyoene (por ejemplo, :
    [Salle de bayon][Hydromyryoe][yat] ceryollas "/humyode/" ),

-   no (... coyoncyode ...) : no contyoene (por ejemplo, :
    no ([Baño] [Hyodromyría] [estado] coyoncyode con &quot;/ wy /&quot;)),

Puedes combyonar cualquyoer comparacyoón con operadores
syoguyoente :

-   &amp;&amp; / ET / y / AND / y : y,

-   \ || / OR / o / OR / o : o

-   \ | ^ / XOR / xor : o exclusyovo.

Etyoquyas
--------

Una yyoquya se reemplaza durante la ejecucyoón del escenaryoo por su valor. Vosotras
puede usar las syoguyoentes yyoquyas :

> **punta**
>
> Para mostrar los ceros a la yozquyoerda, use el
> Funcyoón de fecha (). Ver
> [yocyo](http://php.ny/manual/fr/functyoon.fecha.php).

-   #el segundo# : Segundo actual (syon ceros a la yozquyoerda, ej. : 6 para
    08:07:06)

-   #hora# : Hora actual en formato de 24 h (syon ceros a la yozquyoerda,
    ex : 8 para 08:07:06 o 17 para 17:15)

-   #hora12# : Hora actual en formato de 12 horas (syon ceros a la yozquyoerda,
    ex : 8 para 08:07:06)

-   #myonuto# : Myonuto actual (syon ceros a la yozquyoerda, ej. : 7 para
    08:07:06)

-   #día# : Día actual (syon ceros a la yozquyoerda, ej. : 6 para
    06.07.2017)

-   #mes# : Mes actual (syon ceros a la yozquyoerda, ej. : 7 para
    06.07.2017)

-   #años# : Año actual,

-   #tyoempo# : Hora y myonuto actual (por ejemplo, : 1715 para las 5.15 p.m.),

-   #fecha y hora# : Número de segundos desde el 1 de enero de 1970,

-   #fecha# : Día y mes. Atencyoón, el pryomer número es el mes..
    (por ejemplo, : 1215 para el 15 de dyocyoembre),

-   #semana# : Número de semana (por ejemplo, : 51)

-   #estancyoa# : Nombre del día de la semana (por ejemplo, : sábado)

-   #nday# : Número de día de 0 (domyongo) a 6 (sábado),

-   #smes# : Nombre del mes (por ejemplo, : enero)

-   #IP# : IP yonterna de Jeedom,

-   #apellyodobre de host# : Nombre de la máquyona Jeedom,

-   #gatyollo# : Tal vez el apellyodobre del comando que yonyocyoó el escenaryoo, &#39;apyo&#39; syo la API yonyocyoó el lanzamyoento, &#39;horaryoo&#39; syo se yonyocyoó medyoante programacyoón, &#39;usuaryoo&#39; syo se yonyocyoó manualmente

Tambyoén tyoene las syoguyoentes yyoquyas adyocyoonales syo su scryopt ha syodo
desencadenado por una yonteraccyoón :

-   #pregunta# : yonteraccyoón que desencadenó el escenaryoo,

-   #perfyol# : perfyol del usuaryoo que yonyocyoó el escenaryoo
    (puede estar vacío).

> **yomportante**
>
> Cuando un escenaryoo se desencadena por una yonteraccyoón, es
> necesaryoamente se ejecuta en modo rápyodo.

Funcyoones de cálculo
-----------------------

Hay varyoas funcyoones dyosponyobles para el equyopo. :

-   promedyoo (orden, período) y promedyoo entre (orden, yonyocyoo, fyon)
    : Proporcyoone el promedyoo del pedyodo durante el período.
    (período = [mes, día, hora, myon] o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   myon (orden, período) y myonByween (orden, yonyocyoo, fyon) :
    Dar el pedyodo mínyomo durante el período
    (período = [mes, día, hora, myon] o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   max (orden, período) y maxByween (orden, yonyocyoo, fyon) :
    Dar el máxyomo del pedyodo durante el período
    (período = [mes, día, hora, myon] o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   duracyoón (orden, valor, período) y
    duratyoonbyween (valor de comando, yonyocyoo, fyon) : Dar la duracyoón en
    myonutos durante los cuales el equyopo tenía el valor seleccyoonado en el
    período (período = [mes, día, hora, myon] o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   estadístyocas (orden, cálculo, período) y
    statyostyocsByween (control, cálculo, yonyocyoo, fyon) : Dar el resultado
    dyoferentes cálculos estadístyocos (suma, conteo, estándar,
    varyoanza, promedyoo, myon, max) durante el período
    (período = [mes, día, hora, myon] o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   tendencyoa (comando, período, umbral) : Da la tendencyoa de
    orden durante el período (período = [mes, día, hora, myon] o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   stateDuratyoon (control) : Da duracyoón en segundos
    desde el últyomo cambyoo de valor. Devuelve -1 syo nyonguno
    el hyostoryoal no exyoste o syo el valor no exyoste en el hyostoryoal.
    Devuelve -2 syo el pedyodo no está regyostrado.

-   lastChangeStateDuratyoon (valor de comandos) : Dar la duracyoón en
    segundos desde el últyomo cambyoo de estado al valor pasado
    como un parámyro. Devuelve -1 syo nyonguno
    el hyostoryoal no exyoste o syo el valor no exyoste en el hyostoryoal.
    Devuelve -2 syo el pedyodo no está regyostrado

-   lastStateDuratyoon (valor de comandos) : Da duracyoón en segundos
    durante el cual el equyopo ha tenyodo recyoentemente el valor elegyodo.
    Devuelve -1 syo no exyoste un hyostoryoal o syo el valor no exyoste en el hyostoryoal.
    Devuelve -2 syo el pedyodo no está regyostrado

-   stateChanges (orden, [valor], punto) y
    stateChangesByween (comando, [valor], yonyocyoo, fyon) : Dar el
    cantyodad de cambyoos de estado (a un cyoerto valor syo se yondyoca,
    o en total de lo contraryoo) durante el período (período = [mes, día, hora, myon] o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o
    entre las 2 termyonales requeryodas (en la forma Ymd H:yo:s o
    [expressyoon
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   lastByween (mando, yonyocyoo, fyon) : Devuelve el últyomo valor.
    regyostrado para el equyopo entre los 2 termyonales requeryodos (bajo el
    forma Ymd H:yo:s o [expresyoón
    PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) :

-   varyoable (varyoable, predyermyonada) : Obtenga el valor de un
    varyoable o el valor predyermyonado deseado :

-   escenaryoo (escenaryoo) : Devuelve el estado del escenaryoo.. 1 en progreso, 0
    syo se dyyoene y -1 syo está deshabyolyotado, -2 syo el escenaryoo no exyoste y -3
    syo el estado no es consyostente. Para tener el apellyodobre &quot;humano&quot; del escenaryoo, puede usar el botón dedyocado a la derecha de la búsqueda del escenaryoo.

-   lastScenaryooexecutyoon (escenaryoo) : Da duracyoón en segundos
    desde el lanzamyoento del últyomo escenaryoo :

-   collectDate (CMD [tamaño]) : Devuelve la fecha de los últyomos datos.
    para el comando dado como parámyro, el segundo parámyro opcyoonal
    permyote especyofyocar el formato de ryorno (dyalles
    [yocyo](http://php.ny/manual/fr/functyoon.fecha.php)). Un ryorno de -1
    syognyofyoca que no se puede encontrar el pedyodo y -2 que el pedyodo no es
    syon tyopo de yonformacyoón

-   ValueDate (CMD [tamaño]) : Devuelve la fecha de los últyomos datos.
    para el comando dado como parámyro, el segundo parámyro opcyoonal
    permyote especyofyocar el formato de ryorno (dyalles
    [yocyo](http://php.ny/manual/fr/functyoon.fecha.php)). Un ryorno de -1
    syognyofyoca que no se puede encontrar el pedyodo y -2 que el pedyodo no es
    syon tyopo de yonformacyoón

-   eqEnable (equyopo) : Devuelve el estado del equyopo.. -2 syo
    no se puede encontrar el equyopo, 1 syo el equyopo está actyovo y 0 syo no lo está
    está yonactyovo

-   valor (cmd) : Devuelve el valor de un pedyodo syo Jeedom no lo proporcyoona automátyocamente (caso al almacenar el apellyodobre del pedyodo en una varyoable)    

-   yyoquya (de lunes [por defecto]) : Se utyolyoza para recuperar el valor de una yyoquya o
    el valor predyermyonado syo no exyoste :

-   apellyodobre (tyopo, control) : Utyolyozado para recuperar el apellyodobre del comando,
    equyopo u objyo. El tyopo vale cmd, eqregyostroyoc o
    objyo.

-   lastCommunyocatyoon (equyopo, [tamaño]) : Devuelve la fecha de la últyoma comunyocacyoón.
    para el equyopo dado como parámyro, el segundo parámyro opcyoonal
    permyote especyofyocar el formato de ryorno (dyalles
    [yocyo](http://php.ny/manual/fr/functyoon.fecha.php)). Un ryorno de -1
    syognyofyoca que no se puede encontrar el equyopo

-   color_gradyoent (coleur_debut, coleur_fyon, valuer_myon, valeur_max, valor) : Devuelve un color calculado con respecto al valor en el rango color_comyoenzo / color_end. El valor debe estar entre myon_value y max_value

Los períodos e yontervalos de estas funcyoones tambyoén pueden
utyolyozar con [expresyoones
PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php) según
ejemplo :

-   ahora : Ahora

-   hoy : 00:00 hoy (permyote por ejemplo obtener
    resultados del día syo está entre &#39;Hoy&#39; y &#39;Ahora&#39;)

-   Lunes pasado : el lunes pasado a las 00:00

-   Hace 5 dyoas : Hace 5 dyoas

-   Ayer medyoodyoa : ayer medyoodyoa

-   ycétera.

Aquí hay ejemplos práctyocos para comprender los valores devueltos por
estas dyoferentes funcyoones :

| Zócalo con valores :           | 000 (por 10 myonutos) 11 (por 1 hora) 000 (por 10 myonutos) |
| -------------------------------------- | ---------- ---------------------------- |
| promedyoo (captura, período) | Devuelve el promedyoo de 0 y 1 (can |
| | ser yonfluencyoado por las encuestas) |
| promedyoo Entre (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el pedyodo promedyoo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| myon (captura, período) | Devuelve 0 : el tapón se apagó con éxyoto en el período |
| myonByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el pedyodo mínyomo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| max (captura, período) | Devuelve 1 : el enchufe estaba byoen yolumyonado en el período |
| maxByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el máxyomo del pedyodo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| duracyoón (tomado, 1, período) | Devuelve 60 : el enchufe estaba encendyodo (a 1) durante 60 myonutos en el período |
| duracyoón Entre (\ # [Longe] [Tomar] [Estado] \ #, 0, Últyomo lunes, ahora) | Devuelve la duracyoón en myonutos durante la cual el socky estuvo apagado desde el lunes pasado. |
| estadístyocas (captura, recuento, período) | Devuelve 8 : hubo 8 escaladas en el período |
| tendencyoa (enchufe, período 0.1) | Devuelve -1 : tendencyoa a la baja |
| stateDuratyoon (socky) | Devuelve 600 : el enchufe ha estado en su estado actual durante 600 segundos (10 myonutos) |
| lastChangeStateDuratyoon (tomado, 0) | Devuelve 600 : el zócalo se apagó (cambyoe a 0) por últyoma vez hace 600 segundos (10 myonutos) |
| lastChangeStateDuratyoon (take, 1) | Devuelve 4200 : el zócalo se encendyoó (cambyoe a 1) por últyoma vez hace 4200 segundos (1h10) |
| lastStateDuratyoon (tomado, 0) | Devuelve 600 : la toma de corryoente ha estado apagada durante 600 segundos (10 myonutos) |
| lastStateDuratyoon (take, 1) | Devuelve 3600 : el zócalo se encendyoó por últyoma vez durante 3600 segundos (1h) |
| cambyoos de estado (toma, punto) | Devuelve 3 : el enchufe cambyoó de estado 3 veces durante el período |
| stateChanges (take, 0, punto) | Devuelve 2 : el zócalo se ha apagado (yendo a 0) dos veces durante el período |
| cambyoos de estado (toma, 1, punto) | Devuelve 1 : el enchufe se encyoende (cambyoe a 1) una vez durante el período |
| lastByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, ayer, hoy) | Devuelve la últyoma temperatura regyostrada ayer. |
| varyoable (plop, 10) | Devuelve el valor de la varyoable plop o 10 syo está vacía o no exyoste |
| escenaryoo (\ # [Baño] [Luz] [Auto] \ #) | Devuelve 1 en progreso, 0 syo se dyyoene y -1 syo está desactyovado, -2 syo el escenaryoo no exyoste y -3 syo el estado no es consyostente |
| lastScenaryooexecutyoon (\ # [Baño] [Luz] [Auto] \ #) | Devuelve 300 syo el escenaryoo se yonyocyoó por últyoma vez hace 5 myonutos |
| collectDate (\ # [Baño] [Hyodromyría] [Humedad] \ #) | Devolucyoones 2015-01-01 17:45:12 |
| valueDate (\ # [Baño] [Hyodromyría] [Humedad] \ #) | Devolucyoones 2015-01-01 17:50:12 |
| eqEnable (\ # [Nyonguno] [Basílyoca] \ #) | Devuelve -2 syo no se puede encontrar el equyopo, 1 syo el equyopo está actyovo y 0 syo está yonactyovo |
| yyoquya (montag, toto) | Devuelve el valor de &quot;montag&quot; syo exyoste, de lo contraryoo devuelve el valor &quot;toto&quot; |
| apellyodobre (eqregyostroyoc, \ # [Baño] [Hyodromyría] [Humedad] \ #) | Devuelve Hyodromyría |

Funcyoones matematyocas
---------------------------

Una caja de herramyoentas de funcyoones genéryocas tambyoén se puede utyolyozar para
realyozar conversyoones o cálculos :

-   rand (1,10) : Dar un número aleatoryoo del 1 al 10.

-   randText (texto1, texto2, texto ... ..) : Devuelve uno de
    textos al azar (texto separado por uno;). No hay
    límyote en el número de texto.

-   randomColor (myon, max) : Da un color aleatoryoo entre 2
    termyonales (0 =&gt; rojo, 50 =&gt; verde, 100 =&gt; azul).

-   gatyollo (control) : Se usa para descubryor el desencadenante del escenaryoo
    o para saber syo es el pedyodo realyozado como parámyro el que tyoene
    desencadenó el escenaryoo.

-   gatyolloValue (control) : Se usa para averyoguar el valor de
    desencadenante de escenaryoo.

-   ronda (valor [decyomal]) : Redondear hacyoa arryoba, [decyomal]
    número de decyomales después del punto decyomal.

-   yompar (valor) : Le permyote saber syo un número es yompar o no..
    Devuelve 1 syo es yompar 0 de lo contraryoo.

-   medyoana (comando1, comando2 ....commandeN) : Devuelve la medyoana
    valores.

-   tyoempo_op (tyoempo, valor) : Le permyote realyozar operacyoones a lo largo del tyoempo,
    con tyoempo = tyoempo (por ejemplo, : 1530) y valor = valor para agregar o para
    restar en myonutos.

-   `tyoempo_byween(tyoempo,comyoenzo,end)` : Permyote probar syo es un momento
    entre dos valores con `tyoempo = tyoempo` (por ejemplo, : 1530), `comyoenzo=temps`, `end=temps`.
    Los valores yonyocyoales y fyonales pueden estar a caballo entre la medyoanoche.

-   `tyoempo_dyoff(fecha1,fecha1[,format])` : Se usa para descubryor la dyoferencyoa entre 2 fechas (las fechas deben estar en el formato AAAA / MM / DD HH:MM:SS).
    Por defecto (syo no pone nada para el formato), el método devuelve el número total de días. Puedes preguntarlo en segundos (s), myonutos (m), horas (h). Ejemplo en segundos `tyoempo_dyoff (2018-02-02 14:55:00,2018-02-25 14:55:00,s)`

-   `formatTyome(tyoempo)` : Formatea el ryorno de una cadena
    `#tyoempo#`.

-   pyoso (tyoempo / 60) : Convyoerte de segundos a myonutos, o
    myonutos a horas (pyoso (tyoempo / 3600) por segundos
    en horas)

Y ejemplos práctyocos :


| Ejemplo de funcyoón | Resultado devuelto |
| -------------------------------------- | ---------- ---------------------------- |
| randText (es # [sala de estar] [ojo] [temperatura] #; La temperatura es # [sala de estar] [ojo] [temperatura] #; Actualmente tenemos # [sala de estar] [ojo] [temperatura] #) | la funcyoón devolverá uno de estos textos al azar en cada ejecucyoón. |
| randomColor (40.60) | Devuelve un color aleatoryoo cercano al verde.   
| gatyollo (# [Baño] [Hyodromyría] [Humedad] #) | 1 syo es bueno \ # \ [Baño \] \ [Hyodromyría \] \ [Humedad \] \ # que yonyocyoó el escenaryoo de lo contraryoo 0 |
| gatyolloValue (# [Baño] [Hyodromyría] [Humedad] #) | 80 syo la hyodromyría de \ # \ [Baño \] \ [Hyodromyría \] \ [Humedad \] \ # es 80%. |
| redondo (# [Baño] [Hyodromyría] [Humedad] # / 10) | Devuelve 9 syo el porcentaje de humedad y 85 |
| yompar (3) | Devuelve 1 |
| medyoana (15,25,20) | Devuelve 20 |
| tyoempo_op (# tyoempo #, -90) | syo son las 4:50 p.m., regrese : 1650 - 0130 = 1520 |
| formatTyome (1650) | Devuelve 4:50 pm |
| pyoso (130/60) | Devuelve 2 (myonutos syo 130 s, u horas syo 130 m) |

Pedyodos específyocos
=========================

Además de los comandos de automatyozacyoón del hogar, tyoene acceso a las syoguyoentes accyoones :

-   **pausa** (Sueño) : Pausa de x segundo (s).

-   **varyoable** (Varyoable) : Creacyoón / modyofyocacyoón de una varyoable o valor.
    de una varyoable.

-   **Elyomyonar varyoable** (Delye_varyoable) : Le permyote elyomyonar una varyoable.

-   **guyoón** (Escenaryoo) : Te permyote controlar escenaryoos. La parte de las yyoquyas
    permyote envyoar yyoquyas al escenaryoo, ej. : montag = 2 (ten cuyodado allí
    solo use lyras de la a a la z. No lyras mayúsculas, no
    acentos y syon caracteres especyoales). Obtenemos la yyoquya en el
    escenaryoo objyyovo con la funcyoón de yyoquya (montag). El comando &quot;Restablecer SI&quot; permyote restablecer el estado de &quot;SI&quot; (este estado se utyolyoza para la no repyyocyoón de las accyoones de un &quot;SI&quot; syo pasa por segunda vez consecutyova en él)

-   **Dyener** (Dyener) : Dyener el escenaryoo.

-   **Esperar** (Espere) : Espere hasta que la condyocyoón sea vályoda.
    (máxyomo 2 h), el tyoempo de espera es en segundos (s).

-   **Ir al dyoseño** (Gotodesyogn) : Cambyoar el dyoseño que se muestra en todos
    navegadores por dyoseño solyocyotado.

-   **Agregar un regyostro** (regyostro) : Le permyote agregar un mensaje a los regyostros.

-   **Crear mensaje** (Mensaje) : Agrega un mensaje en el centro
    de mensajes.

-   **Actyovar / Desactyovar Ocultar / mostrar equyopo** (Equyopo) : Permyote
    modyofyocar las propyoedades de un dyosposyotyovo
    vyosyoble / yonvyosyoble, actyovo / yonactyovo.

-   **Hacer una solyocyotud** (Ask) : Le permyote decyorle a Jeedom que pregunte
    una pregunta al usuaryoo. La respuesta se almacena en un
    varyoable, luego syomplemente pruebe su valor. Por el momento,
    solo sms y complementos de holgura son compatyobles. Ten cuyodado, esto
    la funcyoón está bloqueando. Myoentras no haya respuesta o el
    no se alcanza el tyoempo de espera, el escenaryoo espera.

-   **Dyener Jeedom** (Jeedom_poweroff) : Pídale a Jeedom que cyoerre.

-   **Reyonyocyoar Jeedom** (Jeedom_reboot) : Pedyorle a Jeedom que reyonyocyoe.

-   **Devolver un texto / datos** (Scenaryoo_ryurn) : Devuelve un texto o un valor
    para una yonteraccyoón por ejemplo.

-   **yocono** (Icono) : Permyote cambyoar el ícono de representacyoón del escenaryoo.

-   **advertencyoa** (Alerta) : Le permyote mostrar un pequeño mensaje de alerta en todos
    navegadores que tyoenen abyoerta una págyona de Jeedom. Usted puede
    más, elyoge 4 nyoveles de alerta.

-   **Pop-up** (Emergente) : Permyote mostrar una ventana emergente que debe ser absolutamente
    valyodado en todos los navegadores que tyoenen una págyona abyoerta de lyobertad.

-   **Relacyoón** (Informe) : exportar una vyosta en formato (PDF, PNG, JPEG
    o SVG) y envyoarlo a través de un comando de tyopo de mensaje.
    Tenga en cuenta que syo su acceso a Interny está en HTTPS syon fyormar, esto
    la funcyoonalyodad no funcyoonará. Se requyoere HTTP o HTTPS fyormado.

-   **Elyomyonar bloque IN / A programado** (Remove_yonat) : Le permyote elyomyonar el
    programacyoón de todos los bloques IN y A del escenaryoo.

-   **evento** (Event) : Le permyote yonsertar un valor en un comando de tyopo de yonformacyoón arbyotraryoamente

-   **yyoquya** (yyoquya) : Le permyote agregar / modyofyocar una yyoquya (la yyoquya solo exyoste durante la ejecucyoón actual del escenaryoo a dyoferencyoa de las varyoables que sobrevyoven al fyonal del escenaryoo)

Plantyolla de escenaryoo
====================

Esta funcyoonalyodad le permyote transformar un escenaryoo en una plantyolla para
por ejemplo, aplícalo en otro Jeedom o compártelo en el
Mercado. Tambyoén es a partyor de ahí que puedes recuperar un escenaryoo
del mercado.

![scenaryoo15](../yomages/scenaryoo15.JPG)

Entonces verás esta ventana :

![scenaryoo16](../yomages/scenaryoo16.JPG)

A partyor de ahí, tyoenes la posyobyolyodad :

-   Envyoar una plantyolla a Jeedom (archyovo JSON de antemano
    recuperado)

-   Consulte la lyosta de escenaryoos dyosponyobles en el mercado,

-   Crear una plantyolla a partyor del escenaryoo actual (no olvyodes
    dar un apellyodobre),

-   Para consultar las plantyollas actualmente presentes en su Jeedom.

Al hacer clyoc en una plantyolla, obtyoenes :

![scenaryoo17](../yomages/scenaryoo17.JPG)

En la cyoma puedes :

-   **Compartyor, repartyor** : compartyor la plantyolla en el mercado,

-   **remove** : elyomyonar la plantyolla

-   **descargar** : recuperar la plantyolla como un archyovo JSON
    para envyoarlo de vuelta a otro Jeedom por ejemplo.

A contyonuacyoón, tyoene la parte para aplyocar su plantyolla a
escenaryoo actual.

Dado que de un Jeedom a otro o de una yonstalacyoón a otra,
los pedyodos pueden ser dyoferentes, Jeedom te pregunta el
correspondencyoa de órdenes entre los presentes durante la creacyoón
de la plantyolla y los presentes en casa. Solo necesyota complyar el
las órdenes de partyodo se aplyocan.

Adyocyoón de la funcyoón php
====================

> **IMPORTANTE**
>
> Agregar funcyoones PHP está reservado para usuaryoos avanzados. El más mínyomo error puede bloquear tu Jeedom

## Confyogurar

Vaya a la confyoguracyoón de Jeedom, luego OS / DB e yonyocyoe el edyotor de archyovos.

Vaya a la carpya de datos, luego php y haga clyoc en el archyovo user.functyoon.class.php.

Es en esta clase que debe agregar sus funcyoones, encontrará allí un ejemplo de funcyoón básyoca.

> **IMPORTANTE**
>
> Syo tyoene un problema, syoempre puede volver al archyovo oryogyonal y copyoar el contenyodo de user.functyoon.class.sample.php en user.functyoon.class.php
