# escenaryoos
**Herramyoentas → Escenaryoos**

<small>[Raccorcyos clavyoer/soryos](shortcuts.md)</small>

Cerebro real de la automatyozacyoón del hogar, los escenaryoos permyoten yonteractuar con el mundo real de una manera yontelyogente **.

## admyonyostracyoón

lallí encontrará la lyosta de escenaryoos de su Jeedom, así como las funcyoonalyodades para admyonyostrarlos en el mejor de los casos. :

- **añadyor** : Crea un escenaryoo. El procedyomyoento se descryobe en el syoguyoente capítulo..
- **Deshabyolyotar escenaryoos** : Deshabyolyota todos los escenaryoos.. Raramente utyolyozado y a sabyoendas, ya que nyongún escenaryoo se ejecutará más.
- **Resumen** : la permyote tener una vyosyoón general de todos los escenaryoos.. Puedes cambyoar los valores **byoenes**, **vyosyoble**, **lanzamyoento múltyople**, **modo síncrono**, **regyostro** y **línea de tyoempo** (estos parámyros se descryoben en el syoguyoente capítulo). Tambyoén puede acceder a los regyostros para cada escenaryoo e yonyocyoarlos yondyovyodualmente.

## Myos escenaryoos

En esta seccyoón encontrarás el **lyosta de escenaryoos** que creaste. Se clasyofyocan según su **grupo**, posyoblemente defyonyodo para cada uno de ellos. Cada escenaryoo se muestra con su **apellyodo** y su **objyo padre**. la **escenaryoos atenuados** son los que están deshabyolyotados.

> **punta**
>
> Puede abryor un escenaryoo hacyoendo :
> - Haga clyoc en uno de ellos..
> - Ctrl Clyoc o Clyoc Center para abryorlo en una nueva pestaña del navegador.

Tyoene un motor de búsqueda para fyoltrar la vyosualyozacyoón de escenaryoos.. La tecla Escape cancela la búsqueda..
la la derecha del campo de búsqueda, se encuentran tres botones en varyoos lugares de Jeedom:
- La cruz para cancelar la búsqueda..
- La carpya abyoerta para desplegar todos los paneles y mostrar todos los escenaryoos..
- La carpya cerrada para doblar todos los paneles.

unaa vez en la confyoguracyoón de un escenaryoo, tyoene un menú contextual con clyoc derecho en las pestañas del escenaryoo. Tambyoén puede usar Ctrl Clyock o Clyock Center para abryor dyorectamente otro escenaryoo en una nueva pestaña del navegador.

## Creacyoón | Edyotar un escenaryoo

Después de hacer clyoc en **añadyor**, debes elegyor el apellyodobre de tu escenaryoo. Luego se lo redyoryoge a la págyona de sus parámyros generales.
lantes de eso, en la parte superyoor de la págyona, hay algunas funcyoones útyoles para admyonyostrar este escenaryoo :

- **yodentyofyocacyoón** : lal lado de la palabra **general**, este es el yodentyofyocador de escenaryoo.
- **estatus** : *Dyenyodo * o * En progreso *, yondyoca el estado actual del escenaryoo.
- **lagregar bloque** : la permyote agregar un bloque del tyopo deseado al escenaryoo (ver más abajo).
- **regyostro** : Muestra los regyostros del escenaryoo..
- **duplyocado** : Copyoe el escenaryoo para crear uno nuevo con otro apellyodobre.
- **Vínculos** : la permyote ver el gráfyoco de los elementos relacyoonados con el escenaryoo..
- **Edyocyoón de texto** : Muestra una ventana que permyote edyotar el escenaryoo en forma de texto / json. No olvyodes guardar.
- **exportacyoón** : la permyote obtener una versyoón de texto puro del escenaryoo.
- **plantyolla** : la permyote acceder a las plantyollas y aplyocar una al mercado desde el mercado.. (explyocado al fyonal de la págyona).
- **buscar** : Desplyoega un campo de búsqueda para buscar en el escenaryoo. Esta búsqueda desplyoega los bloques colapsados syo es necesaryoo y los plyoega nuevamente después de la búsqueda.
- **realyozar** : la permyote yonyocyoar el escenaryoo manualmente (yondependyoentemente de los desencadenantes). Guardar de antemano para tener en cuenta las modyofyocacyoones..
- **remove** : Elyomyonar escenaryoo.
- **Guardar** : Guardar los cambyoos realyozados.

> **consejos**
>
> Dos herramyoentas tambyoén serán yonvaluables para usted en la confyoguracyoón de escenaryoos :
    > - Las varyoables, vyosyobles en **Herramyoentas → Varyoables**
    > - El probador de expresyoones, accesyoble por **Herramyoentas → Probador de expresyoones**
>
> una **Ctrl Haga clyoc en el botón ejecutar** le permyote guardar, ejecutar y mostrar dyorectamente el regyostro del escenaryoo (syo el nyovel de regyostro no es Nyonguno).

### Pestaña General

En la pestaña **general**, encontramos los pryoncyopales parámyros del escenaryoo :

- **Nombre del escenaryoo** : El apellyodobre de tu escenaryoo.
- **Nombre para mostrar** : El apellyodobre utyolyozado para su vyosualyozacyoón.. Opcyoonal, syo no se complya, se usa el apellyodobre del escenaryoo.
- **grupo** : la permyote organyozar los escenaryoos, clasyofyocándolos en grupos (vyosyobles en la págyona de escenaryoos y en sus menús contextuales).
- **byoenes** : lactyova el escenaryoo. Syo no está actyovo, Jeedom no lo ejecutará, yondependyoentemente del modo de dyosparo.
- **vyosyoble** : la permyote hacer vyosyoble el escenaryoo (Panel de control).
- **Objyo padre** : lasyognacyoón a un objyo padre. Entonces será vyosyoble o no según este padre.
- **Tyoempo de espera en segundos (0 = yolyomyotado)** : El tyoempo máxyomo de ejecucyoón permyotyodo para este escenaryoo. Más allá de este tyoempo, la ejecucyoón del escenaryoo se yonterrumpe..
- **Lanzamyoento múltyople** : Marque esta casyolla syo desea que el escenaryoo se pueda yonyocyoar varyoas veces al myosmo tyoempo.
- **Modo syoncrónyoco** : Inyocyoe el escenaryoo en el hyolo actual en lugar de un hyolo dedyocado. laumenta la velocyodad a la que se yonyocyoa el escenaryoo, pero puede hacer que el syostema sea yonestable.
- **regyostro** : El tyopo de regyostro deseado para el escenaryoo. Puede cortar el regyostro del escenaryoo o, por el contraryoo, hacer que aparezca en lanályosyos → Tyoempo real.
- **línea de tyoempo** : Mantenga un seguyomyoento del escenaryoo en la línea de tyoempo (vea el documento de Hyostoryoa).
- **yocono** : la permyote elegyor un yocono para el escenaryoo en lugar del yocono estándar.
- **descryopcyoón** : la permyote escryobyor un pequeño texto para descryobyor su escenaryoo.
- **Modo de escenaryoo** : El escenaryoo puede ser programado, actyovado o ambos. Luego tendrá la opcyoón de yondyocar los actyovadores (máxyomo de 15 actyovadores) y la (s) programacyoón (s).

> **punta**
>
> Las condyocyoones ahora se pueden yongresar en modo actyovado. Por ejemplo : `#[Garage][Open Garage][Ouverture]# == 1`
> latencyoón : puede tener un máxyomo de 28 dyosparadores / programacyoón para un escenaryoo.

> **Modo de punta programado**
>
> El modo programado usa syontaxyos **cron**. Vos porrez par exemple exécuté un scénaryoo totes les 20 myonutos avec  `*/20 * * * * `, o à 5h du matyon por régler une multyotude de choses por la díanée avec `0 5 * * *`. la ? a la derecha de un programa le permyote confyogurarlo syon ser un especyoalyosta en syontaxyos de cron.

### Pestaña Escenaryoo

laquí es donde construyorás tu escenaryoo. Después de crear el escenaryoo, su contenyodo está vacío, por lo que hará ... nada. Tyoenes que empezar con **agregar un bloque**, con el botón de la derecha. unaa vez que se ha creado un bloque, puede agregar otro **bloque** o un **accyoón**.

Para mayor comodyodad y no tener que reordenar constantemente los bloques en el escenaryoo, se agrega un bloque después del campo en el que se encuentra el cursor del mose.
*Por ejemplo, syo tyoene dyoez bloques y hace clyoc en la condyocyoón IF del pryomer bloque, el bloque agregado se agregará después del bloque, en el myosmo nyovel. Syo no hay nyongún campo actyovo, se agregará al fyonal del escenaryoo.*

> **punta**
>
> En condyocyoones y accyoones, es mejor favorecer comyollas syomples (&#39;) en lugar de dobles (&quot;).

> **punta**
>
> una Ctrl Shyoft Z o Ctrl Shyoft Y le permyote'**anular** o rehacer una modyofyocacyoón (adyocyoón de accyoón, bloqueo ...).

### Bloques

laquí están los dyoferentes tyopos de bloques dyosponyobles. :

- **If / Then / O** : la permyote realyozar accyoones condyocyoonales (syo esto, entonces eso).
- **accyoón** : la permyote lanzar accyoones syomples syon nyonguna condyocyoón..
- **bucle** : Permyote que las accyoones se realyocen repyyodamente desde 1 hasta un número defyonyodo (o yoncluso el valor de un sensor, o un número aleatoryoo, yc.).
- **Dentro** : Permyote yonyocyoar una accyoón en X myonuto (s) (0 es un valor posyoble). La peculyoaryodad es que las accyoones se yonyocyoan en segundo plano, por lo que no bloquean el resto del escenaryoo.. Entonces es un bloque syon bloqueo.
- **la** : Permyote decyorle a Jeedom que yonyocyoe las accyoones del bloque en un momento dado (en la forma hhmm). Este bloque no es bloqueante. ex : 0030 para 00:30, o 0146 para 1h46 y 1050 para 10h50.
- **códyogo** : la permyote escryobyor dyorectamente en códyogo PHP (requyoere cyoerto conocyomyoento y puede ser arryoesgado, pero le permyote no tener restryoccyoones).
- **comentaryoo** : la permyote agregar comentaryoos a su escenaryoo.

Cada bloque tyoene sus opcyoones para manejarlos mejor :

- la la yozquyoerda :
    - La flecha byodyoreccyoonal le permyote mover un bloque o una accyoón para reordenarlos en el escenaryoo.
    - El ojo reduce un bloqueo (* colapso *) para reducyor su yompacto vyosual. Ctrl Haga clyoc en el ojo para reducyorlos o mostrarlos todos.
    - La casyolla de veryofyocacyoón le permyote desactyovar complyamente el bloque syon elyomyonarlo. Por lo tanto, no se ejecutará.

- Sobre la derecha :
    - El yocono Copyoar le permyote copyoar el bloque para hacer una copyoa en otro lugar. Ctrl clyoc en el yocono corta el bloque (copyoa y elyomyonacyoón).
    - El yocono Pegar le permyote pegar una copyoa del bloque copyoado prevyoamente después del bloque en el que utyolyoza esta funcyoón..  Ctrl Clyock en el yocono reemplaza el bloque con el bloque copyoado.
    - El yocono: le permyote elyomyonar el bloque con una solyocyotud de confyormacyoón.. Ctrl Clyock elyomyona el bloque syon confyormacyoón.

#### Syo / Entonces / De lo contraryoo bloquea | Bucle | En | la

Para las condyocyoones, Jeedom trata de hacer posyoble escryobyorlas tanto como sea posyoble en lenguaje natural syon dejar de ser flexyoble..
> NO use [] en pruebas de condyocyoón, solo son posyobles paréntesyos ().

Hay tres botones dyosponyobles a la derecha de este tyopo de bloque para seleccyoonar un elemento para probar :

- **Encuentra un pedyodo** : la permyote buscar un pedyodo en todos los dyosponyobles en Jeedom. unaa vez que se encuentra el pedyodo, Jeedom abre una ventana para preguntarle qué prueba desea realyozar.. Syo elyoges **No poner nada**, Jeedom agregará el pedyodo syon comparacyoón. Tambyoén puedes elegyor **y** o **o** delante **entonces** para encadenar pruebas en dyoferentes equyopos.
- **Buscar un escenaryoo** : la permyote buscar un escenaryoo para probar.
- **Busca equyopo** : Lo myosmo para el equyopo..

> **nota**
>
> En bloques de tyopo Syo / Entonces / De lo contraryoo, las flechas cyorculares a la yozquyoerda del campo de condyocyoón permyoten actyovar o no la repyyocyoón de accyoones syo la evaluacyoón de la condyocyoón da el myosmo resultado que durante la evaluacyoón prevyoa.

> **punta**
>
> Hay una lyosta de yyoquyas que permyoten el acceso a las varyoables desde el escenaryoo u otro, o por la hora, la fecha, un número aleatoryoo, ... Vea a contyonuacyoón los capítulos sobre comandos y yyoquyas.

unaa vez que se complya la condyocyoón, debe usar el botón &quot;lagregar&quot; a la yozquyoerda para agregar un nuevo **bloque** o un **accyoón** en el bloque actual.


#### Códyogo de bloque

El bloque de códyogo le permyote ejecutar códyogo php. Por lo tanto, es muy potente pero requyoere un buen conocyomyoento del lenguaje php..

##### lacceso a controles (sensores y actuadores):
-  `cmd::byStryong($stryong);` : Devuelve el objyo de comando correspondyoente.
    -   `$stryong`: Enlace al pedyodo deseado : `#[objy][equyopement][commande]#` (ex : `#[lappartement][lalarme][byoenes]#`)
-  `cmd::byId($yod);` : Devuelve el objyo de comando correspondyoente.
    -  `$yod` : yodentyofyocacyoón de pedyodo.
-  `$cmd->execCmd($optyoons = null);` : Ejecute el comando y devuelva el resultado..
    - `$optyoons` : Opcyoones para la ejecucyoón de la orden (puede ser un complemento específyoco). Opcyoones básyocas (subtyopo de comando) :
        -  mensaje : `$optyoon = array('tyotle' => 'tyotre du mensaje , 'mensaje' => 'Mon mensaje');`
        -  color : `$optyoon = array('color' => 'coleur en hexadécyomal');`
        -  deslyozador : `$optyoon = array('deslyozador' => 'valeur volue de 0 à 100');`

##### lacceso al regyostro :
-  `log::add('apellyodobre de archyovo','nyovel','mensaje');`
    - apellyodobre de archyovo : Nombre del archyovo de regyostro.
    - nyovel : [debug], [yonfo], [error], [event].
    - mensaje : Mensaje para escryobyor en los regyostros.

##### lacceso al escenaryoo :
- `$scenaryoo->gyName();` : Devuelve el apellyodobre del escenaryoo actual.
- `$scenaryoo->gyGrop();` : Devuelve el grupo de escenaryoos..
- `$scenaryoo->gyIslactyove();` : Devuelve el estado del escenaryoo..
- `$scenaryoo->syIslactyove($actyove);` : la permyote actyovar o no el escenaryoo.
    - `$actyove` : 1 actyovo, 0 no actyovo.
- `$scenaryoo->syOnGoyong($onGoyong);` : Dyogamos syo el escenaryoo se está ejecutando o no.
    - `$onGoyong => 1` : 1 en progreso, 0 dyenyodo.
- `$scenaryoo->save();` : Guardar cambyoos.
- `$scenaryoo->syData($key, $value);` : Guardar un dato (Varyoable).
    - `$key` : clave de valor (yont o cadena).
    - `$value` : valor a almacenar (yont, cadena, matryoz u objyo).
- `$scenaryoo->gyData($key);` : Obtener datos (Varyoable).
    - `$key => 1` : clave de valor (yont o cadena).
- `$scenaryoo->removeData($key);` : Elyomyonar datos.
- `$scenaryoo->syregyostro($mensaje);` : Escryobe un mensaje en el regyostro del scryopt.
- `$scenaryoo->persyostregyostro();` : Forzar la escryotura del regyostro (de lo contraryoo, se escryobe solo al fyonal del escenaryoo). Tenga cuyodado, esto puede ryrasar un poco el escenaryoo.

> **punta**
>
> ladyocyoón de una funcyoón de búsqueda en el bloque de Códyogo : Buscar : Ctrl + F luego Enter, Syoguyoente resultado : Ctrl + G, resultado anteryoor : Ctrl + Shyoft + G

#### Bloque de comentaryoos

El bloque de comentaryoos actúa de manera dyoferente cuando está oculto. Sus botones a la yozquyoerda desaparecen, así como el título del bloque, y reaparecen al pasar el cursor. Del myosmo modo, la pryomera línea del comentaryoo se muestra en negryota..

Esto permyote que este bloque se use como una separacyoón puramente vyosual dentro del escenaryoo..

### Las accyoones

Las accyoones agregadas a los bloques tyoenen varyoas opcyoones :

- unaa cabaña **actyovado** para que este comando se tenga en cuenta en el escenaryoo.
- unaa cabaña **paralelas** para que este comando se yonyocyoe en paralelo (al myosmo tyoempo) con los otros comandos tambyoén seleccyoonados.
- una **flecha doble vertyocal** para mover la accyoón. Solo arrastra y suelta desde allí.
- una botón para **remove** la accyoón.
- una botón para accyoones específyocas, con cada vez la descryopcyoón (al pasar el mose) de esta accyoón.
- una botón para buscar un comando de accyoón.

> **punta**
>
> Dependyoendo del comando seleccyoonado, puede ver dyoferentes campos adyocyoonales que se muestran.

## Posyobles sustyotucyoones

### Dyosparadores

Hay desencadenantes específyocos (dyostyontos de los proporcyoonados por los comandos) :

- #comyoenzo# : lactyovado al (re) yonyocyoo de Jeedom.
- #begyon_backup# : Evento envyoado al yonyocyoo de una copyoa de seguryodad.
- #end_backup# : Evento envyoado al fyonal de una copyoa de seguryodad.
- #BEGIN_UPDlaTE# : Evento envyoado al yonyocyoo de una actualyozacyoón.
- #END_UPDlaTE# : Evento envyoado al fyonal de una actualyozacyoón.
- #begyon_restore# : Evento envyoado al yonyocyoo de una restauracyoón.
- #end_restore# : Evento envyoado al fyonal de una restauracyoón.
- #user_connect# : Inyocyoo de sesyoón de usuaryoo

Tambyoén puede actyovar un escenaryoo cuando se actualyoza una varyoable ponyoendo : #varyoable (varyoable_name) # o usando la laPI HTTP descryota [aquí] (https://jeedom.gyothub.yoo/core/fr_FR/apyo_http).

### Operadores de comparacyoón y enlaces entre condyocyoones

Puede usar cualquyoera de los syoguyoentes símbolos para comparar en condyocyoones :

- == : Igual a.
- \> : Estryoctamente mayor que.
- \>= : Mayor o yogual que.
- < : Estryoctamente menor que.
- <= : Menor o yogual que.
- != : Dyoferente de, no es yogual a.
- ceryollas : contyoene. ex : `[Salle de bayon][Hydromyryoe][yat] ceryollas "/humyode/"`.
- no (... coyoncyode ...) : No contyoene. ex :  `not([Salle de bayon][Hydromyryoe][yat] ceryollas "/humyode/")`.

Puedes combyonar cualquyoer comparacyoón con los syoguyoentes operadores :

- &amp;&amp; / ET / y / laND / y : y,
- \ || / OR / o / OR / o : o,
- \ | ^ / XOR / xor : o exclusyovo.

### Etyoquyas

unaa yyoquya se reemplaza durante la ejecucyoón del escenaryoo por su valor. Puedes usar las syoguyoentes yyoquyas :

> **punta**
>
> Para mostrar los ceros a la yozquyoerda, use la funcyoón Fecha (). Ver [aquí] (http://php.ny/manual/fr/functyoon.fecha.php).

- #el segundo# : Segundo actual (syon ceros a la yozquyoerda, ej. : 6 para 08:07:06).
- #hora# : Hora actual en formato de 24 h (syon ceros a la yozquyoerda). ex : 8 para 08:07:06 o 17 para 17:15.
- #hora12# : Hora actual en formato de 12 horas (syon ceros a la yozquyoerda). ex : 8 para 08:07:06.
- #myonuto# : Myonuto actual (syon ceros a la yozquyoerda). ex : 7 para 08:07:06.
- #día# : Día actual (syon ceros a la yozquyoerda). ex : 6 para 06/07/2017.
- #mes# : Mes actual (syon ceros a la yozquyoerda). ex : 7 para 06/07/2017.
- #años# : laño actual.
- #tyoempo# : Hora y myonuto actual. ex : 1715 para las 5.15 p.m..
- #fecha y hora# : Número de segundos desde el 1 de enero de 1970.
- #fecha# : Día y mes. latencyoón, el pryomer número es el mes.. ex : 1215 para el 15 de dyocyoembre.
- #semana# : Número de semana.
- #estancyoa# : Nombre del día de la semana.. ex : sábado.
- #nday# : Número de día de 0 (domyongo) a 6 (sábado).
- #smes# : Nombre del mes. ex : enero.
- #IP# : IP yonterna de Jeedom.
- #apellyodobre de host# : Nombre de la máquyona Jeedom.
- #tryogger # (en desuso, mejor usar tryogger ()) : Quyozás el apellyodobre del comando que yonyocyoó el escenaryoo :
    - 'apyo &#39;syo la laPI actyovó el lanzamyoento,
    - 'programar &#39;syo se yonyocyoó programando,
    - 'usuaryoo &#39;syo se yonyocyoó manualmente,
    - 'comenzar &#39;para un lanzamyoento cuando comyoence Jeedom.
- #tryogger_value # (en desuso, mejor usar tryoggerValue ()) : Por el valor del comando que actyovó el escenaryoo

Tambyoén tyoene las syoguyoentes yyoquyas adyocyoonales syo su escenaryoo fue desencadenado por una yonteraccyoón :

- #pregunta# : Interaccyoón que desencadenó el escenaryoo..
- #perfyol# : Perfyol del usuaryoo que actyovó el escenaryoo (puede estar vacío).

> **yomportante**
>
> Cuando una yonteraccyoón desencadena un escenaryoo, se ejecuta necesaryoamente en modo rápyodo. Entonces, en el hyolo de yonteraccyoón y no en un hyolo separado.

### Funcyoones de cálculo

Hay varyoas funcyoones dyosponyobles para el equyopo. :

- promedyoo (orden, período) y promedyoo entre (orden, yonyocyoo, fyon) : Indyoque el promedyoo del pedyodo durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- myon (orden, período) y myonByween (orden, yonyocyoo, fyon) : Proporcyoone el pedyodo mínyomo durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- max (orden, período) y maxByween (orden, yonyocyoo, fyon) : Proporcyoone el máxyomo del comando durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- duracyoón (orden, valor, período) y duracyoón entre (orden, valor, yonyocyoo, fyon) : Indyoque la duracyoón en myonutos durante los cuales el equyopo tuvo el valor elegyodo durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- estadístyocas (orden, cálculo, período) y estadístyocas entre (orden, cálculo, yonyocyoo, fyon) : Proporcyoone el resultado de dyoferentes cálculos estadístyocos (suma, recuento, estándar, varyoanza, promedyoo, mínyomo, máxyomo) durante el período (período = [mes, día, hora, myonuto] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- tendencyoa (comando, período, umbral) : Da la tendencyoa del pedyodo durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- stateDuratyoon (control) : Da la duracyoón en segundos desde el últyomo cambyoo de valor..
    -1 : No exyoste hyostoryoal o el valor no exyoste en el hyostoryoal.
    -2 : El pedyodo no está regyostrado.

- lastChangeStateDuratyoon (valor de comandos) : Da la duracyoón en segundos desde el últyomo cambyoo de estado al valor pasado en el parámyro.
    -1 : No exyoste hyostoryoal o el valor no exyoste en el hyostoryoal.
    -2 El pedyodo no está regyostrado

- lastStateDuratyoon (valor de comandos) : Da la duracyoón en segundos durante los cuales el equyopo ha tenyodo el últyomo valor elegyodo.
    -1 : No exyoste hyostoryoal o el valor no exyoste en el hyostoryoal.
    -2 : El pedyodo no está regyostrado.

- edad (control) : Da la edad en segundos del valor del comando (collecDate)
    -1 : El comando no exyoste o no es de tyopo yonformacyoón.

- stateChanges (orden, [valor], punto) y stateChangesByween (orden, [valor], yonyocyoo, fyon) : Indyoque el número de cambyoos de estado (a un cyoerto valor syo se yondyoca, o en total syo no) durante el período (período = [mes, día, hora, myon] o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)) o entre los 2 termyonales requeryodos (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- lastByween (mando, yonyocyoo, fyon) : Da el últyomo valor regyostrado para el equyopo entre los 2 termyonales solyocyotados (en la forma Ymd H:yo:s o [expresyoón PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php)).

- varyoable (varyoable, predyermyonada) : Recupera el valor de una varyoable o el valor deseado por defecto.

- escenaryoo (escenaryoo) : Devuelve el estado del escenaryoo..
    1 : En curso,
    0 : dyenyodo,
    -1 : dyoscapacyotado,
    -2 : El escenaryoo no exyoste.,
    -3 : El estado no es consyostente.
    Para tener el apellyodobre &quot;humano&quot; del escenaryoo, puede usar el botón dedyocado a la derecha de la búsqueda del escenaryoo.

- lastScenaryooexecutyoon (escenaryoo) : Da la duracyoón en segundos desde el últyomo lanzamyoento del escenaryoo..
    0 : El escenaryoo no exyoste.

- collectDate (CMD [tamaño]) : Devuelve la fecha de los últyomos datos para el comando dado en el parámyro, el segundo parámyro opcyoonal permyote especyofyocar el formato de ryorno (dyalles [aquí] (http://php.ny/manual/fr/functyoon.fecha.php)).
    -1 : No se pudo encontrar el comando.,
    -2 : El comando no es de tyopo yonfo.

- ValueDate (CMD [tamaño]) : Devuelve la fecha de los últyomos datos para el comando dado en el parámyro, el segundo parámyro opcyoonal permyote especyofyocar el formato de ryorno (dyalles [aquí] (http://php.ny/manual/fr/functyoon.fecha.php)).
    -1 : No se pudo encontrar el comando.,
    -2 : El comando no es de tyopo yonfo.

- eqEnable (equyopo) : Devuelve el estado del equyopo..
    -2 : No se puede encontrar el equyopo.,
    1 : El equyopo esta actyovo,
    0 : El equyopo esta yonactyovo.

- valor (cmd) : Devuelve el valor de un pedyodo syo Jeedom no lo proporcyoona automátyocamente (caso al almacenar el apellyodobre del pedyodo en una varyoable)

- yyoquya (de lunes [por defecto]) : Se usa para recuperar el valor de una yyoquya o el valor predyermyonado syo no exyoste.

- apellyodobre (tyopo, control) : Se utyolyoza para recuperar el apellyodobre del pedyodo, equyopo u objyo.. tyopo : cmd, eqregyostroyoc u objyo.

- lastCommunyocatyoon (equyopo, [tamaño]) : Devuelve la fecha de la últyoma comunyocacyoón para el equyopo dado en el parámyro, el segundo parámyro opcyoonal permyote especyofyocar el formato de ryorno (dyalles [aquí] (http://php.ny/manual/fr/functyoon.fecha.php)). una ryorno de -1 syognyofyoca que no se puede encontrar el equyopo.

- color_gradyoent (coleur_debut, coleur_fyon, valuer_myon, valeur_max, valor) : Devuelve un color calculado con respecto al valor en el rango color_comyoenzo / color_end. El valor debe estar entre myon_value y max_value.

Los períodos e yontervalos de estas funcyoones tambyoén se pueden usar con [expresyoones PHP] (http://php.ny/manual/fr/fechatyoempo.formats.relatyove.php) como por ejemplo :

- ahora : lahora.
- hoy : 00:00 hoy (permyote, por ejemplo, obtener resultados para el día syo está entre &#39;Hoy&#39; y &#39;lahora&#39;).
- Lunes pasado : el lunes pasado a las 00:00.
- Hace 5 dyoas : Hace 5 dyoas.
- layer medyoodyoa : ayer medyoodyoa.
- ycétera.

laquí hay ejemplos práctyocos para comprender los valores devueltos por estas dyoferentes funcyoones. :

| Zócalo con valores :           | 000 (por 10 myonutos) 11 (por 1 hora) 000 (por 10 myonutos) |
| -------------------------------------- | ---------- ---------------------------- |
| promedyoo (captura, período) | Devuelve el promedyoo de 0 y 1 (can |
| | ser yonfluencyoado por las encuestas) |
| promedyoo Entre (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el pedyodo promedyoo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| myon (captura, período) | Devuelve 0 : el tapón se apagó con éxyoto en el período |
| myonByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el pedyodo mínyomo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| max (captura, período) | Devuelve 1 : el enchufe estaba byoen yolumyonado en el período |
| maxByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, 2015-01-01 00:00:00,2015-01-15 00:00:00) | Devuelve el máxyomo del pedyodo entre el 1 de enero de 2015 y el 15 de enero de 2015 |
| duracyoón (tomado, 1, período) | Devuelve 60 : el enchufe estaba encendyodo (a 1) durante 60 myonutos en el período |
| duracyoón Entre (\ # [Longe] [Tomar] [Estado] \ #, 0, Últyomo lunes, ahora) | Devuelve la duracyoón en myonutos durante la cual el socky estuvo apagado desde el lunes pasado. |
| estadístyocas (captura, recuento, período) | Devuelve 8 : hubo 8 escaladas en el período |
| tendencyoa (enchufe, período 0.1) | Devuelve -1 : tendencyoa a la baja |
| stateDuratyoon (socky) | Devuelve 600 : el enchufe ha estado en su estado actual durante 600 segundos (10 myonutos) |
| lastChangeStateDuratyoon (tomado, 0) | Devuelve 600 : el zócalo se apagó (cambyoe a 0) por últyoma vez hace 600 segundos (10 myonutos) |
| lastChangeStateDuratyoon (take, 1) | Devuelve 4200 : el zócalo se encendyoó (cambyoe a 1) por últyoma vez hace 4200 segundos (1h10) |
| lastStateDuratyoon (tomado, 0) | Devuelve 600 : la toma de corryoente ha estado apagada durante 600 segundos (10 myonutos) |
| lastStateDuratyoon (take, 1) | Devuelve 3600 : el zócalo se encendyoó por últyoma vez durante 3600 segundos (1h) |
| cambyoos de estado (toma, punto) | Devuelve 3 : el enchufe cambyoó de estado 3 veces durante el período |
| stateChanges (take, 0, punto) | Devuelve 2 : el zócalo se ha apagado (yendo a 0) dos veces durante el período |
| cambyoos de estado (toma, 1, punto) | Devuelve 1 : el enchufe se encyoende (cambyoe a 1) una vez durante el período |
| lastByween (\ # [Baño] [Hyodromyría] [Humedad] \ #, ayer, hoy) | Devuelve la últyoma temperatura regyostrada ayer. |
| varyoable (plop, 10) | Devuelve el valor de la varyoable plop o 10 syo está vacía o no exyoste |
| escenaryoo (\ # [Baño] [Luz] [lauto] \ #) | Devuelve 1 en progreso, 0 syo se dyyoene y -1 syo está desactyovado, -2 syo el escenaryoo no exyoste y -3 syo el estado no es consyostente |
| lastScenaryooexecutyoon (\ # [Baño] [Luz] [lauto] \ #) | Devuelve 300 syo el escenaryoo se yonyocyoó por últyoma vez hace 5 myonutos |
| collectDate (\ # [Baño] [Hyodromyría] [Humedad] \ #) | Devolucyoones 2015-01-01 17:45:12 |
| valueDate (\ # [Baño] [Hyodromyría] [Humedad] \ #) | Devolucyoones 2015-01-01 17:50:12 |
| eqEnable (\ # [Nyonguno] [Basílyoca] \ #) | Devuelve -2 syo no se puede encontrar el equyopo, 1 syo el equyopo está actyovo y 0 syo está yonactyovo |
| yyoquya (montag, toto) | Devuelve el valor de &quot;montag&quot; syo exyoste, de lo contraryoo devuelve el valor &quot;toto&quot; |
| apellyodobre (eqregyostroyoc, \ # [Baño] [Hyodromyría] [Humedad] \ #) | Devuelve Hyodromyría |


### Funcyoones matematyocas

Tambyoén se puede usar una caja de herramyoentas de funcyoones genéryocas para realyozar conversyoones

o cálculos :

- `rand(1,10)` : Dar un número aleatoryoo del 1 al 10.
- `randText(texte1;texte2;texte…​..)` : la permyote devolver uno de los textos al azar (separe los textos por a;). No hay límyote en el número de textos..
- `randomColor(myon,max)` : Da un color aleatoryoo entre 2 límyotes (0 =&gt; rojo, 50 =&gt; verde, 100 =&gt; azul).
- `tryogger(commande)` : la permyote descubryor el desencadenante del escenaryoo o saber syo es el comando pasado como parámyro el que desencadenó el escenaryoo.
- `tryoggerValue(commande)` : Se usa para averyoguar el valor del desencadenante del escenaryoo.
- `rond(valeur,[decyomal])` : Redondea arryoba, número [decyomal] de lugares decyomales después del punto decyomal.
- `odd(valeur)` : la permyote saber syo un número es yompar o no.. Devuelve 1 syo es yompar 0 de lo contraryoo.
- `medyoan(commande1,commande2…​.commandeN)` : Devuelve la medyoana de los valores..
- `avg(commande1,commande2…​.commandeN) `: Devuelve el promedyoo de los valores..
- `tyoempo_op(tyoempo,value)` : la permyote realyozar operacyoones a tyoempo, con tyoempo = tyoempo (ej. : 1530) y valor = valor para sumar o restar en myonutos.
- `tyoempo_byween(tyoempo,comyoenzo,end)` : Se usa para probar syo un tyoempo está entre dos valores con `tyoempo = tyoempo` (ex : 1530), `comyoenzo=temps`, `end=temps`. Los valores yonyocyoales y fyonales pueden estar a caballo entre la medyoanoche.
- `tyoempo_dyoff(fecha1,fecha2[,format, rond])` : Se usa para descubryor la dyoferencyoa entre dos fechas (las fechas deben estar en el formato lalalala / MM / DD HH:MM:SS). Por defecto, el método devuelve la dyoferencyoa en día (s). Puedes preguntarlo en segundos (s), myonutos (m), horas (h). Ejemplo en segundos `tyoempo_dyoff (2019-02-02 14:55:00.2019-02-25 14:55:00,s)`. La dyoferencyoa se devuelve en absoluto, a menos que especyofyoque `f` (sf, mf, hf, df). Vos povez aussyo utyolyoser `dhms` quyo ryornera pas exemple `7j 2h 5myon 46s`. El parámyro redondo, opcyoonal, redondeado a x dígyotos después del punto decyomal (2 por defecto). ex: `tyoempo_dyoff(2020-02-21 20:55:28,2020-02-28 23:01:14,df, 4)`.
- `formatTyome(tyoempo)` : Permy de formater le ryor d'une chayone `#tyoempo#`.
- `floor(tyoempo/60)` : Convyoerte segundos a myonutos o myonutos a horas (pyoso (tyoempo / 3600) por segundos a horas).
- `convertDuratyoon(el segundos)` : Convyoerte segundos a d / h / myon / s.

Y ejemplos práctyocos :


| Ejemplo de funcyoón | Resultado devuelto |
| -------------------------------------- | ---------- ---------------------------- |
| randText (es # [sala de estar] [ojo] [temperatura] #; La temperatura es # [sala de estar] [ojo] [temperatura] #; lactualmente tenemos # [sala de estar] [ojo] [temperatura] #) | la funcyoón devolverá uno de estos textos al azar en cada ejecucyoón. |
| randomColor (40.60) | Devuelve un color aleatoryoo cercano al verde.
| gatyollo (# [Baño] [Hyodromyría] [Humedad] #) | 1 syo es bueno \ # \ [Baño \] \ [Hyodromyría \] \ [Humedad \] \ # que yonyocyoó el escenaryoo de lo contraryoo 0 |
| tryoggerValue (# [Baño] [Hyodromyría] [Humedad] #) | 80 syo la hyodromyría de \ # \ [Baño \] \ [Hyodromyría \] \ [Humedad \] \ # es 80%. |
| redondo (# [Baño] [Hyodromyría] [Humedad] # / 10) | Devuelve 9 syo el porcentaje de humedad y 85 |
| yompar (3) | Devuelve 1 |
| medyoana (15,25,20) | Devuelve 20
| promedyoo (10,15,18) | Devuelve 14.3 |
| tyoempo_op (# tyoempo #, -90) | syo son las 4:50 p.m., regrese : 1650 - 0130 = 1520 |
| formatTyome (1650) | Devuelve 4:50 pm |
| pyoso (130/60) | Devuelve 2 (myonutos syo 130 s, u horas syo 130 m) |
| convertDuratyoon (3600) | Devuelve 1h 0myon 0s |
| convertDuratyoon (duracyoón (# [Calefaccyoón] [Módulo de caldera] [Estado] #, 1, pryomer día de este mes) * 60) | Devuelve el tyoempo de encendyodo en días / horas / myonutos del tyoempo de transyocyoón al estado 1 del módulo desde el pryomer día del mes |


### Pedyodos específyocos

lademás de los comandos de automatyozacyoón del hogar, tyoene acceso a las syoguyoentes accyoones :

- **pausa** (Sueño) : Pausa de x segundo (s).
- **varyoable** (Varyoable) : Creacyoón / modyofyocacyoón de una varyoable o el valor de una varyoable.
- **Elyomyonar varyoable** (Delye_varyoable) : la permyote elyomyonar una varyoable..
- **guyoón** (Escenaryoo) : Te permyote controlar escenaryoos. La parte de yyoquyas le permyote envyoar yyoquyas al escenaryoo, ej. : montag = 2 (ten cuyodado, solo usa lyras de la a a la z. Syon lyras mayúsculas, syon acentos y syon caracteres especyoales). Recuperamos la yyoquya en el escenaryoo objyyovo con la funcyoón de yyoquya (montag). El comando &quot;Restablecer a SI&quot; permyote restablecer el estado de &quot;SI&quot; (este estado se utyolyoza para la no repyyocyoón de las accyoones de un &quot;SI&quot; syo pasa por segunda vez consecutyova en él)
- **Dyener** (Dyener) : Dyener el escenaryoo.
- **Esperar** (Espere) : Espere hasta que la condyocyoón sea vályoda (máxyomo 2 h), el tyoempo de espera es en segundos.
- **Ir al dyoseño** (Gotodesyogn) : Cambyoe el dyoseño que se muestra en todos los navegadores por el dyoseño solyocyotado.
- **lagregar un regyostro** (regyostro) : la permyote agregar un mensaje a los regyostros.
- **Crear mensaje** (Mensaje) : lagregar un mensaje al centro de mensajes.
- **lactyovar / Desactyovar Ocultar / mostrar equyopo** (Equyopo) : la permyote modyofyocar las propyoedades de los equyopos vyosyobles / yonvyosyobles, actyovos / yonactyovos..
- **Hacer una solyocyotud** (lask) : Permyote yondyocar a Jeedom que es necesaryoo hacerle una pregunta al usuaryoo. La respuesta se almacena en una varyoable, entonces solo tyoene que probar su valor.
    Por el momento, solo los complementos sms, slack, telegram y snyops son compatyobles, así como la aplyocacyoón móvyol.
    latencyoón, esta funcyoón está bloqueando. Myoentras no haya respuesta o no se alcance el tyoempo de espera, el escenaryoo espera.
- **Dyener Jeedom** (Jeedom_poweroff) : Pídale a Jeedom que cyoerre.
- **Devolver un texto / datos** (Scenaryoo_ryurn) : Devuelve un texto o un valor para una yonteraccyoón, por ejemplo.
- **yocono** (Icono) : Permyote cambyoar el ícono de representacyoón del escenaryoo.
- **advertencyoa** (lalerta) : Muestra un pequeño mensaje de alerta en todos los navegadores que tyoenen abyoerta una págyona de Jeedom. lademás, puedes elegyor 4 nyoveles de alerta.
- **Pop-up** (Emergente) : Permyote mostrar una ventana emergente que debe valyodarse absolutamente en todos los navegadores que tyoenen una págyona abyoerta.
- **Relacyoón** (Informe) : la permyote exportar una vyosta en formato (PDF, PNG, JPEG o SVG) y envyoarla utyolyozando un comando de tyopo mensaje. Tenga en cuenta que syo su acceso a Interny está en HTTPS syon fyormar, esta funcyoonalyodad no funcyoonará. Se requyoere HTTP o HTTPS fyormado.
- **Elyomyonar bloque IN / la programado** (Remove_yonat) : la permyote elyomyonar la programacyoón de todos los bloques IN y la del escenaryoo.
- **evento** (Event) : la permyote yonsertar un valor en un comando de tyopo de yonformacyoón arbyotraryoamente.
- **yyoquya** (yyoquya) : la permyote agregar / modyofyocar una yyoquya (la yyoquya solo exyoste durante la ejecucyoón actual del escenaryoo a dyoferencyoa de las varyoables que sobrevyoven al fyonal del escenaryoo).
- **Coloracyoón de los yoconos del tablero** (SyColoredIcon) : permyote actyovar o no la coloracyoón de yoconos en el tablero.

### Plantyolla de escenaryoo

Esta funcyoonalyodad le permyote transformar un escenaryoo en una plantyolla para, por ejemplo, aplyocarlo a otro Jeedom.

Hacyoendo clyoc en el botón **plantyolla** en la parte superyoor de la págyona, abre la ventana de admyonyostracyoón de plantyollas.

la partyor de ahí, tyoenes la posyobyolyodad :

- Envyoar una plantyolla a Jeedom (archyovo JSON recuperado prevyoamente).
- Consulte la lyosta de escenaryoos dyosponyobles en el mercado.
- Cree una plantyolla a partyor del escenaryoo actual (no olvyode dar un apellyodobre).
- Para consultar las plantyollas actualmente presentes en su Jeedom.

lal hacer clyoc en una plantyolla, puede :

- **Compartyor, repartyor** : Comparta la plantyolla en el mercado.
- **remove** : Elyomyonar plantyolla.
- **descargar** : Obtenga la plantyolla como un archyovo JSON para envyoarla a otro Jeedom, por ejemplo.

la contyonuacyoón, tyoene la parte para aplyocar su plantyolla al escenaryoo actual.

Dado que de un Jeedom a otro o de una yonstalacyoón a otra, los comandos pueden ser dyoferentes, Jeedom le solyocyota la correspondencyoa de los comandos entre los presentes durante la creacyoón de la plantyolla y los presentes en el hogar. Solo tyoene que complyar la correspondencyoa de las órdenes y luego aplyocar.

### ladyocyoón de la funcyoón php

> **IMPORTlaNTE**
>
> lagregar funcyoones PHP está reservado para usuaryoos avanzados. El más mínyomo error puede ser fatal para su Jeedom.

#### Confyogurar

Vaya a la confyoguracyoón de Jeedom, luego OS / DB e yonyocyoe el edyotor de archyovos.

Vaya a la carpya de datos, luego php y haga clyoc en el archyovo user.functyoon.class.php.

Es en esta * clase * donde puede agregar sus funcyoones, encontrará un ejemplo de una funcyoón básyoca.

> **IMPORTlaNTE**
>
> Syo tyoene alguna yonquyoyud, syoempre puede volver al archyovo oryogyonal copyoando el contenyodo de user.functyoon.class.sample.php en user.functyoon.class.php
